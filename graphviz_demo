{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "from chemkin_CS207_G9.Reaction import Reaction\n",
    "from chemkin_CS207_G9.ReactionSystem import ReactionSystem\n",
    "from chemkin_CS207_G9.database_query import CoeffQuery"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import os\n",
    "import chemkin_CS207_G9\n",
    "BASE_DIR = os.path.dirname(os.path.abspath(chemkin_CS207_G9.__file__))\n",
    "\n",
    "path_xml = os.path.join(BASE_DIR, 'rxns_reversible.xml') # path to the .xml file\n",
    "path_sql = os.path.join(BASE_DIR, 'nasa_thermo.sqlite')  # path to the .sqlite file"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "nasa_query = CoeffQuery(path_sql)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import sqlite3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "db = sqlite3.connect(path_sql)\n",
    "cursor = db.cursor()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "query = '''SELECT * FROM LOW'''\n",
    "cursor.execute(query).fetchall()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "from chemkin_CS207_G9.xml2dict import xml2dict\n",
    "\n",
    "reader = xml2dict()\n",
    "reader.parse(path_xml)\n",
    "info = reader.get_info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "species = info[0]\n",
    "reactions = [Reaction(**r) for r in info[1]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import graphviz \n",
    "from graphviz import Digraph\n",
    "dot_b = Digraph(comment='Bipartite Graph')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "with dot_b.subgraph(name='cluster_1') as c:\n",
    "    c.attr(style='filled')\n",
    "    c.attr(label='Reaction', labelloc = 'b')\n",
    "    c.attr(color='lightgrey')\n",
    "    for idx, r in enumerate(reactions):\n",
    "        c.node(str(idx))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "metadata": {},
   "outputs": [],
   "source": [
    "with dot_b.subgraph(name='cluster_0') as c:\n",
    "    c.node_attr.update(style='filled')\n",
    "    c.attr(color='blue')\n",
    "    c.attr(label='Species')\n",
    "    for s in species:\n",
    "        c.node(s)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "metadata": {},
   "outputs": [],
   "source": [
    "for idx, r in enumerate(reactions):\n",
    "    for k1 in r.getReactants():\n",
    "        dot_b.edge(k1, str(idx))\n",
    "    for k2 in r.getProducts():\n",
    "        dot_b.edge(str(idx), k2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 2.38.0 (20140413.2041)\n",
       " -->\n",
       "<!-- Title: %3 Pages: 1 -->\n",
       "<svg width=\"814pt\" height=\"192pt\"\n",
       " viewBox=\"0.00 0.00 814.00 192.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 188)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-188 810,-188 810,4 -4,4\"/>\n",
       "<g id=\"clust1\" class=\"cluster\"><title>cluster_1</title>\n",
       "<polygon fill=\"lightgrey\" stroke=\"lightgrey\" points=\"8,-8 8,-82 798,-82 798,-8 8,-8\"/>\n",
       "<text text-anchor=\"middle\" x=\"403\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">Reaction</text>\n",
       "</g>\n",
       "<g id=\"clust2\" class=\"cluster\"><title>cluster_0</title>\n",
       "<polygon fill=\"none\" stroke=\"blue\" points=\"148,-102 148,-176 733,-176 733,-102 148,-102\"/>\n",
       "<text text-anchor=\"middle\" x=\"440.5\" y=\"-160.8\" font-family=\"Times,serif\" font-size=\"14.00\">Species</text>\n",
       "</g>\n",
       "<!-- 0 -->\n",
       "<g id=\"node1\" class=\"node\"><title>0</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"115\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"115\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">0</text>\n",
       "</g>\n",
       "<!-- O -->\n",
       "<g id=\"node13\" class=\"node\"><title>O</title>\n",
       "<ellipse fill=\"lightgrey\" stroke=\"black\" cx=\"183\" cy=\"-128\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"183\" y=\"-123.8\" font-family=\"Times,serif\" font-size=\"14.00\">O</text>\n",
       "</g>\n",
       "<!-- 0&#45;&gt;O -->\n",
       "<g id=\"edge3\" class=\"edge\"><title>0&#45;&gt;O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M129.072,-71.4855C138.55,-81.2424 151.221,-94.2867 161.9,-105.279\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"159.432,-107.762 168.91,-112.496 164.453,-102.884 159.432,-107.762\"/>\n",
       "</g>\n",
       "<!-- OH -->\n",
       "<g id=\"node14\" class=\"node\"><title>OH</title>\n",
       "<ellipse fill=\"lightgrey\" stroke=\"black\" cx=\"327\" cy=\"-128\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"327\" y=\"-123.8\" font-family=\"Times,serif\" font-size=\"14.00\">OH</text>\n",
       "</g>\n",
       "<!-- 0&#45;&gt;OH -->\n",
       "<g id=\"edge4\" class=\"edge\"><title>0&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M131.281,-70.6972C137.157,-74.9697 144.06,-79.2726 151,-82 209.499,-104.989 232.501,-79.0109 291,-102 294.796,-103.492 298.58,-105.454 302.191,-107.626\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"300.455,-110.675 310.719,-113.303 304.334,-104.848 300.455,-110.675\"/>\n",
       "</g>\n",
       "<!-- 1 -->\n",
       "<g id=\"node2\" class=\"node\"><title>1</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"475\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"475\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">1</text>\n",
       "</g>\n",
       "<!-- H -->\n",
       "<g id=\"node12\" class=\"node\"><title>H</title>\n",
       "<ellipse fill=\"lightgrey\" stroke=\"black\" cx=\"544\" cy=\"-128\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"544\" y=\"-123.8\" font-family=\"Times,serif\" font-size=\"14.00\">H</text>\n",
       "</g>\n",
       "<!-- 1&#45;&gt;H -->\n",
       "<g id=\"edge7\" class=\"edge\"><title>1&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M489.279,-71.4855C498.896,-81.2424 511.754,-94.2867 522.589,-105.279\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"520.19,-107.831 529.703,-112.496 525.176,-102.917 520.19,-107.831\"/>\n",
       "</g>\n",
       "<!-- 1&#45;&gt;OH -->\n",
       "<g id=\"edge8\" class=\"edge\"><title>1&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M458.164,-70.5045C452.354,-74.66 445.633,-78.9405 439,-82 407.283,-96.6288 394.717,-87.3712 363,-102 359.372,-103.673 355.719,-105.711 352.202,-107.895\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"350.199,-105.024 343.836,-113.495 354.093,-110.841 350.199,-105.024\"/>\n",
       "</g>\n",
       "<!-- 2 -->\n",
       "<g id=\"node3\" class=\"node\"><title>2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"691\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"691\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">2</text>\n",
       "</g>\n",
       "<!-- 2&#45;&gt;H -->\n",
       "<g id=\"edge12\" class=\"edge\"><title>2&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M674.158,-70.4918C668.348,-74.6464 661.628,-78.9296 655,-82 623.697,-96.5002 611.303,-87.4998 580,-102 576.375,-103.679 572.723,-105.721 569.207,-107.906\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"567.203,-105.036 560.842,-113.508 571.098,-110.852 567.203,-105.036\"/>\n",
       "</g>\n",
       "<!-- H2O -->\n",
       "<g id=\"node16\" class=\"node\"><title>H2O</title>\n",
       "<ellipse fill=\"lightgrey\" stroke=\"black\" cx=\"472\" cy=\"-128\" rx=\"27.1044\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"472\" y=\"-123.8\" font-family=\"Times,serif\" font-size=\"14.00\">H2O</text>\n",
       "</g>\n",
       "<!-- 2&#45;&gt;H2O -->\n",
       "<g id=\"edge11\" class=\"edge\"><title>2&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M674.729,-70.7237C668.854,-74.9983 661.949,-79.2957 655,-82 593.553,-105.911 569.447,-78.0888 508,-102 504.2,-103.479 500.413,-105.434 496.8,-107.602\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"494.658,-104.823 488.271,-113.276 498.535,-110.651 494.658,-104.823\"/>\n",
       "</g>\n",
       "<!-- 3 -->\n",
       "<g id=\"node4\" class=\"node\"><title>3</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"187\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"187\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">3</text>\n",
       "</g>\n",
       "<!-- 3&#45;&gt;OH -->\n",
       "<g id=\"edge15\" class=\"edge\"><title>3&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M203.888,-70.3932C209.702,-74.5413 216.411,-78.8455 223,-82 251.414,-95.6036 262.586,-88.3964 291,-102 294.603,-103.725 298.243,-105.794 301.752,-107.993\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"299.859,-110.938 310.112,-113.607 303.761,-105.126 299.859,-110.938\"/>\n",
       "</g>\n",
       "<!-- 4 -->\n",
       "<g id=\"node5\" class=\"node\"><title>4</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"547\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"547\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">4</text>\n",
       "</g>\n",
       "<!-- H2 -->\n",
       "<g id=\"node15\" class=\"node\"><title>H2</title>\n",
       "<ellipse fill=\"lightgrey\" stroke=\"black\" cx=\"698\" cy=\"-128\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"698\" y=\"-123.8\" font-family=\"Times,serif\" font-size=\"14.00\">H2</text>\n",
       "</g>\n",
       "<!-- 4&#45;&gt;H2 -->\n",
       "<g id=\"edge18\" class=\"edge\"><title>4&#45;&gt;H2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M563.457,-70.2812C569.348,-74.5203 576.214,-78.9085 583,-82 615.96,-97.0153 629.04,-86.9847 662,-102 665.711,-103.691 669.446,-105.769 673.033,-107.999\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"671.291,-111.045 681.543,-113.719 675.195,-105.236 671.291,-111.045\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node17\" class=\"node\"><title>O2</title>\n",
       "<ellipse fill=\"lightgrey\" stroke=\"black\" cx=\"255\" cy=\"-128\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"255\" y=\"-123.8\" font-family=\"Times,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- 4&#45;&gt;O2 -->\n",
       "<g id=\"edge19\" class=\"edge\"><title>4&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M531.154,-70.6388C525.208,-75.0156 518.151,-79.3992 511,-82 418.732,-115.558 383.268,-68.4425 291,-102 286.978,-103.463 282.985,-105.49 279.203,-107.763\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"277.206,-104.888 270.846,-113.361 281.102,-110.703 277.206,-104.888\"/>\n",
       "</g>\n",
       "<!-- 5 -->\n",
       "<g id=\"node6\" class=\"node\"><title>5</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"403\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"403\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">5</text>\n",
       "</g>\n",
       "<!-- 5&#45;&gt;OH -->\n",
       "<g id=\"edge22\" class=\"edge\"><title>5&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M387.643,-71.1445C376.832,-81.1019 362.172,-94.6043 349.975,-105.839\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"347.364,-103.485 342.38,-112.834 352.106,-108.634 347.364,-103.485\"/>\n",
       "</g>\n",
       "<!-- 6 -->\n",
       "<g id=\"node7\" class=\"node\"><title>6</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"43\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"43\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">6</text>\n",
       "</g>\n",
       "<!-- 6&#45;&gt;OH -->\n",
       "<g id=\"edge26\" class=\"edge\"><title>6&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M58.8507,-70.6253C64.797,-75.0008 71.8535,-79.3871 79,-82 167.886,-114.499 202.114,-69.5013 291,-102 295.02,-103.47 299.011,-105.501 302.793,-107.775\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"300.894,-110.716 311.149,-113.375 304.79,-104.9 300.894,-110.716\"/>\n",
       "</g>\n",
       "<!-- 6&#45;&gt;O2 -->\n",
       "<g id=\"edge25\" class=\"edge\"><title>6&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M59.2811,-70.6972C65.1573,-74.9697 72.0596,-79.2726 79,-82 137.499,-104.989 160.501,-79.0109 219,-102 222.796,-103.492 226.58,-105.454 230.191,-107.626\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"228.455,-110.675 238.719,-113.303 232.334,-104.848 228.455,-110.675\"/>\n",
       "</g>\n",
       "<!-- 7 -->\n",
       "<g id=\"node8\" class=\"node\"><title>7</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"331\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"331\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">7</text>\n",
       "</g>\n",
       "<!-- 7&#45;&gt;H2O -->\n",
       "<g id=\"edge29\" class=\"edge\"><title>7&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M347.888,-70.3932C353.702,-74.5413 360.411,-78.8455 367,-82 395.414,-95.6036 406.5,-88.5781 435,-102 438.866,-103.821 442.783,-106.017 446.549,-108.342\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"444.693,-111.31 454.97,-113.885 448.542,-105.463 444.693,-111.31\"/>\n",
       "</g>\n",
       "<!-- 7&#45;&gt;O2 -->\n",
       "<g id=\"edge30\" class=\"edge\"><title>7&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M315.643,-71.1445C304.832,-81.1019 290.172,-94.6043 277.975,-105.839\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"275.364,-103.485 270.38,-112.834 280.106,-108.634 275.364,-103.485\"/>\n",
       "</g>\n",
       "<!-- 8 -->\n",
       "<g id=\"node9\" class=\"node\"><title>8</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"619\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"619\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">8</text>\n",
       "</g>\n",
       "<!-- 8&#45;&gt;OH -->\n",
       "<g id=\"edge34\" class=\"edge\"><title>8&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M603.154,-70.6388C597.208,-75.0156 590.151,-79.3992 583,-82 490.732,-115.558 455.268,-68.4425 363,-102 358.978,-103.463 354.985,-105.49 351.203,-107.763\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"349.206,-104.888 342.846,-113.361 353.102,-110.703 349.206,-104.888\"/>\n",
       "</g>\n",
       "<!-- 8&#45;&gt;H2O -->\n",
       "<g id=\"edge33\" class=\"edge\"><title>8&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M602.158,-70.4918C596.348,-74.6464 589.628,-78.9296 583,-82 551.697,-96.5002 539.303,-87.4998 508,-102 504.375,-103.679 500.723,-105.721 497.207,-107.906\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"495.203,-105.036 488.842,-113.508 499.098,-110.852 495.203,-105.036\"/>\n",
       "</g>\n",
       "<!-- 9 -->\n",
       "<g id=\"node10\" class=\"node\"><title>9</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"763\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"763\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">9</text>\n",
       "</g>\n",
       "<!-- 9&#45;&gt;H2 -->\n",
       "<g id=\"edge38\" class=\"edge\"><title>9&#45;&gt;H2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M749.235,-71.8238C740.363,-81.3783 728.662,-93.9792 718.682,-104.727\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"716.025,-102.445 711.785,-112.155 721.154,-107.208 716.025,-102.445\"/>\n",
       "</g>\n",
       "<!-- HO2 -->\n",
       "<g id=\"node18\" class=\"node\"><title>HO2</title>\n",
       "<ellipse fill=\"lightgrey\" stroke=\"black\" cx=\"399\" cy=\"-128\" rx=\"27.1044\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"399\" y=\"-123.8\" font-family=\"Times,serif\" font-size=\"14.00\">HO2</text>\n",
       "</g>\n",
       "<!-- 9&#45;&gt;HO2 -->\n",
       "<g id=\"edge37\" class=\"edge\"><title>9&#45;&gt;HO2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M747.186,-70.7268C741.243,-75.1118 734.179,-79.4782 727,-82 604.688,-124.964 558.584,-59.8178 436,-102 431.877,-103.419 427.779,-105.421 423.895,-107.682\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"421.777,-104.884 415.307,-113.274 425.597,-110.75 421.777,-104.884\"/>\n",
       "</g>\n",
       "<!-- 10 -->\n",
       "<g id=\"node11\" class=\"node\"><title>10</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"259\" cy=\"-56\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"259\" y=\"-51.8\" font-family=\"Times,serif\" font-size=\"14.00\">10</text>\n",
       "</g>\n",
       "<!-- 10&#45;&gt;OH -->\n",
       "<g id=\"edge41\" class=\"edge\"><title>10&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M273.072,-71.4855C282.55,-81.2424 295.221,-94.2867 305.9,-105.279\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"303.432,-107.762 312.91,-112.496 308.453,-102.884 303.432,-107.762\"/>\n",
       "</g>\n",
       "<!-- 10&#45;&gt;HO2 -->\n",
       "<g id=\"edge42\" class=\"edge\"><title>10&#45;&gt;HO2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M275.888,-70.3932C281.702,-74.5413 288.411,-78.8455 295,-82 323.414,-95.6036 334.586,-88.3964 363,-102 366.603,-103.725 370.243,-105.794 373.752,-107.993\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"371.859,-110.938 382.112,-113.607 375.761,-105.126 371.859,-110.938\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;0 -->\n",
       "<g id=\"edge1\" class=\"edge\"><title>H&#45;&gt;0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M528.203,-113.223C522.262,-108.833 515.195,-104.476 508,-102 357.735,-50.2827 301.265,-133.717 151,-82 146.953,-80.6071 142.946,-78.6193 139.157,-76.3653\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"141.056,-73.4242 130.797,-70.7775 137.166,-79.244 141.056,-73.4242\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;4 -->\n",
       "<g id=\"edge17\" class=\"edge\"><title>H&#45;&gt;4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M544.742,-109.697C545.072,-101.983 545.469,-92.7125 545.838,-84.1124\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"549.335,-84.2451 546.267,-74.1043 542.342,-83.9453 549.335,-84.2451\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;5 -->\n",
       "<g id=\"edge21\" class=\"edge\"><title>H&#45;&gt;5</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M527.119,-113.592C521.306,-109.443 514.595,-105.142 508,-102 479.175,-88.2687 467.825,-95.7313 439,-82 435.393,-80.282 431.752,-78.2172 428.242,-76.0201\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"430.135,-73.0753 419.881,-70.4084 426.234,-78.8875 430.135,-73.0753\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;8 -->\n",
       "<g id=\"edge32\" class=\"edge\"><title>H&#45;&gt;8</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M559.177,-112.834C569.851,-102.872 584.319,-89.3687 596.353,-78.1371\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"598.923,-80.5264 603.845,-71.1445 594.146,-75.409 598.923,-80.5264\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;9 -->\n",
       "<g id=\"edge36\" class=\"edge\"><title>H&#45;&gt;9</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M560.271,-113.276C566.146,-109.002 573.051,-104.704 580,-102 641.447,-78.0888 665.553,-105.911 727,-82 730.8,-80.5211 734.587,-78.5657 738.2,-76.3982\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"740.342,-79.1769 746.729,-70.7237 736.465,-73.3489 740.342,-79.1769\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;1 -->\n",
       "<g id=\"edge5\" class=\"edge\"><title>O&#45;&gt;1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M198.846,-113.361C204.792,-108.984 211.849,-104.601 219,-102 311.268,-68.4425 346.732,-115.558 439,-82 443.022,-80.5371 447.015,-78.51 450.797,-76.2374\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"452.794,-79.1124 459.154,-70.6388 448.898,-73.2968 452.794,-79.1124\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;3 -->\n",
       "<g id=\"edge13\" class=\"edge\"><title>O&#45;&gt;3</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M183.989,-109.697C184.43,-101.983 184.959,-92.7125 185.451,-84.1124\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"188.946,-84.2878 186.023,-74.1043 181.958,-83.8883 188.946,-84.2878\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;6 -->\n",
       "<g id=\"edge24\" class=\"edge\"><title>O&#45;&gt;6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M159.653,-118.436C138.152,-110.194 105.648,-96.8244 79,-82 75.509,-80.0579 71.9358,-77.8609 68.4609,-75.5953\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"70.3658,-72.6581 60.1287,-69.9282 66.429,-78.4462 70.3658,-72.6581\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;10 -->\n",
       "<g id=\"edge40\" class=\"edge\"><title>O&#45;&gt;10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M198.38,-112.834C209.196,-102.872 223.857,-89.3687 236.051,-78.1371\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"238.659,-80.4937 243.643,-71.1445 233.916,-75.3448 238.659,-80.4937\"/>\n",
       "</g>\n",
       "<!-- OH&#45;&gt;2 -->\n",
       "<g id=\"edge10\" class=\"edge\"><title>OH&#45;&gt;2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M342.814,-113.272C348.757,-108.887 355.821,-104.521 363,-102 485.735,-58.9032 532.265,-125.097 655,-82 659.038,-80.5819 663.04,-78.5801 666.827,-76.3194\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"668.82,-79.1968 675.186,-70.7277 664.928,-73.3785 668.82,-79.1968\"/>\n",
       "</g>\n",
       "<!-- OH&#45;&gt;7 -->\n",
       "<g id=\"edge28\" class=\"edge\"><title>OH&#45;&gt;7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M327.989,-109.697C328.43,-101.983 328.959,-92.7125 329.451,-84.1124\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"332.946,-84.2878 330.023,-74.1043 325.958,-83.8883 332.946,-84.2878\"/>\n",
       "</g>\n",
       "<!-- H2&#45;&gt;1 -->\n",
       "<g id=\"edge6\" class=\"edge\"><title>H2&#45;&gt;1</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M681.735,-113.262C675.86,-108.987 668.954,-104.692 662,-102 598.868,-77.5616 574.132,-106.438 511,-82 507.197,-80.5278 503.408,-78.5764 499.795,-76.4108\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"501.53,-73.3614 491.265,-70.7378 497.654,-79.19 501.53,-73.3614\"/>\n",
       "</g>\n",
       "<!-- H2&#45;&gt;2 -->\n",
       "<g id=\"edge9\" class=\"edge\"><title>H2&#45;&gt;2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M696.27,-109.697C695.498,-101.983 694.571,-92.7125 693.711,-84.1124\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"697.188,-83.7064 692.71,-74.1043 690.223,-84.403 697.188,-83.7064\"/>\n",
       "</g>\n",
       "<!-- H2O&#45;&gt;3 -->\n",
       "<g id=\"edge14\" class=\"edge\"><title>H2O&#45;&gt;3</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M455.656,-113.378C449.54,-109.002 442.298,-104.616 435,-102 345.908,-70.0697 311.886,-114.499 223,-82 218.98,-80.5302 214.989,-78.4993 211.207,-76.2249\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"213.106,-73.2844 202.851,-70.6253 209.21,-79.0996 213.106,-73.2844\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;0 -->\n",
       "<g id=\"edge2\" class=\"edge\"><title>O2&#45;&gt;0</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M238.112,-113.607C232.298,-109.459 225.589,-105.154 219,-102 190.586,-88.3964 179.414,-95.6036 151,-82 147.397,-80.2749 143.757,-78.2059 140.248,-76.0067\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"142.141,-73.0621 131.888,-70.3932 138.239,-78.8736 142.141,-73.0621\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;4 -->\n",
       "<g id=\"edge16\" class=\"edge\"><title>HO2&#45;&gt;4</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M415.984,-113.785C422.043,-109.551 429.086,-105.149 436,-102 467.395,-87.7 479.697,-96.5002 511,-82 514.625,-80.3209 518.277,-78.2791 521.793,-76.0939\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"523.797,-78.9643 530.158,-70.4918 519.902,-73.148 523.797,-78.9643\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;5 -->\n",
       "<g id=\"edge20\" class=\"edge\"><title>HO2&#45;&gt;5</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M399.989,-109.697C400.43,-101.983 400.959,-92.7125 401.451,-84.1124\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"404.946,-84.2878 402.023,-74.1043 397.958,-83.8883 404.946,-84.2878\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;6 -->\n",
       "<g id=\"edge23\" class=\"edge\"><title>HO2&#45;&gt;6</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M383.183,-113.28C377.24,-108.896 370.177,-104.528 363,-102 243.652,-59.9637 198.348,-124.036 79,-82 74.9629,-80.5781 70.9618,-78.574 67.1759,-76.3123\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"69.0744,-73.3714 58.8167,-70.7201 65.1821,-79.1895 69.0744,-73.3714\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;7 -->\n",
       "<g id=\"edge27\" class=\"edge\"><title>HO2&#45;&gt;7</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M384.91,-112.496C375.428,-102.735 362.756,-89.6897 352.08,-78.6999\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"354.55,-76.2195 345.072,-71.4855 349.529,-81.097 354.55,-76.2195\"/>\n",
       "</g>\n",
       "<!-- H2O2 -->\n",
       "<g id=\"node19\" class=\"node\"><title>H2O2</title>\n",
       "<ellipse fill=\"lightgrey\" stroke=\"black\" cx=\"621\" cy=\"-128\" rx=\"31.948\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"621\" y=\"-123.8\" font-family=\"Times,serif\" font-size=\"14.00\">H2O2</text>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;8 -->\n",
       "<g id=\"edge31\" class=\"edge\"><title>H2O2&#45;&gt;8</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M620.506,-109.697C620.285,-101.983 620.02,-92.7125 619.775,-84.1124\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"623.273,-84.0003 619.489,-74.1043 616.276,-84.2002 623.273,-84.0003\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;9 -->\n",
       "<g id=\"edge35\" class=\"edge\"><title>H2O2&#45;&gt;9</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M640.475,-113.761C647.112,-109.623 654.702,-105.286 662,-102 689.561,-89.5917 699.82,-95.2217 727,-82 730.592,-80.2525 734.225,-78.1703 737.731,-75.9643\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"739.743,-78.8294 746.089,-70.3452 735.837,-73.0203 739.743,-78.8294\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;10 -->\n",
       "<g id=\"edge39\" class=\"edge\"><title>H2O2&#45;&gt;10</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M602.32,-113.024C595.616,-108.729 587.784,-104.483 580,-102 459.028,-63.408 414.772,-124.169 295,-82 290.963,-80.5786 286.962,-78.5748 283.176,-76.3132\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"285.074,-73.3723 274.816,-70.721 281.182,-79.1905 285.074,-73.3723\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.dot.Digraph at 0x1139b8f60>"
      ]
     },
     "execution_count": 123,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dot_b"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import graphviz \n",
    "from graphviz import Digraph\n",
    "dot = Digraph(comment='Hierarchical Graph')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "for s in species:\n",
    "    dot.node(s)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "metadata": {},
   "outputs": [],
   "source": [
    "for r in reactions:\n",
    "    for idx, k1 in enumerate(r.getReactants().keys()):\n",
    "        for k in r.getProducts():\n",
    "            dot.edge(k1, k)\n",
    "        for jdx, k2 in enumerate(r.getReactants().keys()):\n",
    "            if k1 != k2 and jdx > idx:\n",
    "                dot.edge(k1, k2, arrowhead = 'none')   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n",
       "<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n",
       " \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n",
       "<!-- Generated by graphviz version 2.38.0 (20140413.2041)\n",
       " -->\n",
       "<!-- Title: %3 Pages: 1 -->\n",
       "<svg width=\"676pt\" height=\"476pt\"\n",
       " viewBox=\"0.00 0.00 676.00 476.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n",
       "<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 472)\">\n",
       "<title>%3</title>\n",
       "<polygon fill=\"white\" stroke=\"none\" points=\"-4,4 -4,-472 672,-472 672,4 -4,4\"/>\n",
       "<!-- H -->\n",
       "<g id=\"node1\" class=\"node\"><title>H</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"352\" cy=\"-378\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"352\" y=\"-373.8\" font-family=\"Times,serif\" font-size=\"14.00\">H</text>\n",
       "</g>\n",
       "<!-- O -->\n",
       "<g id=\"node2\" class=\"node\"><title>O</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"241\" cy=\"-306\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"241\" y=\"-301.8\" font-family=\"Times,serif\" font-size=\"14.00\">O</text>\n",
       "</g>\n",
       "<!-- H&#45;&gt;O -->\n",
       "<g id=\"edge1\" class=\"edge\"><title>H&#45;&gt;O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M330.666,-366.671C312.025,-356.118 285.247,-339.475 265.715,-326.444\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"267.547,-323.458 257.305,-320.746 263.62,-329.253 267.547,-323.458\"/>\n",
       "</g>\n",
       "<!-- OH -->\n",
       "<g id=\"node3\" class=\"node\"><title>OH</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"316\" cy=\"-90\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"316\" y=\"-85.8\" font-family=\"Times,serif\" font-size=\"14.00\">OH</text>\n",
       "</g>\n",
       "<!-- H&#45;&gt;OH -->\n",
       "<g id=\"edge2\" class=\"edge\"><title>H&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M324.969,-376.891C282.089,-375.846 209.344,-368.62 178,-324 125.192,-248.825 228.173,-144.609 285.143,-106.091\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"287.341,-108.839 293.861,-100.487 283.556,-102.95 287.341,-108.839\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;OH -->\n",
       "<g id=\"edge26\" class=\"edge\"><title>H&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M325.233,-375.491C292.71,-371.918 239.574,-360.407 214,-324 164.07,-252.921 253.414,-155.879 295.821,-112.956\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"298.341,-115.386 302.912,-105.827 293.378,-110.449 298.341,-115.386\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;OH -->\n",
       "<g id=\"edge41\" class=\"edge\"><title>H&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M325.768,-373.528C296.649,-368.291 254.066,-355.412 232,-324 183.123,-254.421 267.705,-159.963 303.743,-115.745\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"306.55,-117.839 310.057,-107.842 301.081,-113.47 306.55,-117.839\"/>\n",
       "</g>\n",
       "<!-- H2 -->\n",
       "<g id=\"node4\" class=\"node\"><title>H2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"486\" cy=\"-162\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"486\" y=\"-157.8\" font-family=\"Times,serif\" font-size=\"14.00\">H2</text>\n",
       "</g>\n",
       "<!-- H&#45;&gt;H2 -->\n",
       "<g id=\"edge22\" class=\"edge\"><title>H&#45;&gt;H2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M345.293,-360.297C351.735,-350.096 364.464,-336.626 375,-324 400.458,-293.492 409.48,-287.155 428,-252 439.928,-229.359 448.852,-201.162 460.148,-182.649\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"463.049,-184.608 465.908,-174.406 457.311,-180.599 463.049,-184.608\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;H2 -->\n",
       "<g id=\"edge46\" class=\"edge\"><title>H&#45;&gt;H2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M376.682,-370.218C395.827,-360.37 414.492,-341.385 429,-324 454.458,-293.492 463.48,-287.155 482,-252 492.977,-231.163 501.411,-205.621 501.891,-187.252\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"505.37,-186.827 501.165,-177.102 498.387,-187.327 505.37,-186.827\"/>\n",
       "</g>\n",
       "<!-- H2O -->\n",
       "<g id=\"node5\" class=\"node\"><title>H2O</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"316\" cy=\"-18\" rx=\"27.1044\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"316\" y=\"-13.8\" font-family=\"Times,serif\" font-size=\"14.00\">H2O</text>\n",
       "</g>\n",
       "<!-- H&#45;&gt;H2O -->\n",
       "<g id=\"edge40\" class=\"edge\"><title>H&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M326.117,-372.375C244.827,-357.122 0,-305.344 0,-235 0,-235 0,-235 0,-161 0,-40.163 194.625,-21.5323 278.394,-19.1098\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"278.592,-22.6063 288.51,-18.8812 278.433,-15.6081 278.592,-22.6063\"/>\n",
       "</g>\n",
       "<!-- O2 -->\n",
       "<g id=\"node6\" class=\"node\"><title>O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"316\" cy=\"-162\" rx=\"27\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"316\" y=\"-157.8\" font-family=\"Times,serif\" font-size=\"14.00\">O2</text>\n",
       "</g>\n",
       "<!-- H&#45;&gt;O2 -->\n",
       "<g id=\"edge3\" class=\"edge\"><title>H&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M345.332,-360.208C334.75,-320.302 317.892,-220.134 314.997,-180.01\"/>\n",
       "</g>\n",
       "<!-- H&#45;&gt;O2 -->\n",
       "<g id=\"edge23\" class=\"edge\"><title>H&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M352.992,-359.849C350.282,-322.57 335.622,-233.938 325.076,-189.442\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"328.447,-188.494 322.628,-179.641 321.656,-190.191 328.447,-188.494\"/>\n",
       "</g>\n",
       "<!-- HO2 -->\n",
       "<g id=\"node7\" class=\"node\"><title>HO2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"389\" cy=\"-234\" rx=\"27.1044\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"389\" y=\"-229.8\" font-family=\"Times,serif\" font-size=\"14.00\">HO2</text>\n",
       "</g>\n",
       "<!-- H&#45;&gt;HO2 -->\n",
       "<g id=\"edge45\" class=\"edge\"><title>H&#45;&gt;HO2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M347.281,-360.153C348.436,-335.181 360.217,-288.203 372.141,-259.446\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"375.435,-260.655 376.347,-250.1 369.051,-257.782 375.435,-260.655\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;H -->\n",
       "<g id=\"edge6\" class=\"edge\"><title>O&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M262.436,-317.386C281.038,-327.924 307.691,-344.488 327.179,-357.484\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"325.331,-360.46 335.574,-363.17 329.257,-354.665 325.331,-360.46\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;OH -->\n",
       "<g id=\"edge7\" class=\"edge\"><title>O&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M227.527,-290.22C219.653,-261.167 230.394,-195.009 253,-144 259.569,-129.178 270.327,-114.054 283.358,-103.776\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"285.462,-106.577 291.748,-98.0489 281.515,-100.796 285.462,-106.577\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;OH -->\n",
       "<g id=\"edge16\" class=\"edge\"><title>O&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M237.712,-287.9C238.215,-257.767 248.977,-193.695 271,-144 276.089,-132.517 283.693,-120.852 291.376,-111.4\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"294.14,-113.556 298.086,-103.723 288.869,-108.949 294.14,-113.556\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;OH -->\n",
       "<g id=\"edge31\" class=\"edge\"><title>O&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M248.346,-288.376C256.101,-258.445 266.86,-193.958 289,-144 293.236,-134.441 299.215,-124.756 304.641,-116.326\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"307.705,-118.034 310.202,-107.737 301.829,-114.229 307.705,-118.034\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;OH -->\n",
       "<g id=\"edge50\" class=\"edge\"><title>O&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M257.298,-291.541C273.324,-263.216 284.045,-195.798 307,-144 311.276,-134.352 317.327,-124.575 321.876,-116.091\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"325.159,-117.34 326.329,-106.81 318.848,-114.312 325.159,-117.34\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;H2 -->\n",
       "<g id=\"edge8\" class=\"edge\"><title>O&#45;&gt;H2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M267.83,-302.952C306.016,-298.862 376.75,-286.826 425,-252 450.973,-233.253 469.465,-199.841 478.881,-179.719\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;H2O -->\n",
       "<g id=\"edge17\" class=\"edge\"><title>O&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M240.791,-287.847C240.8,-269.857 241.462,-240.805 245,-216 254.3,-150.797 253.291,-132.205 280,-72 286.044,-58.3753 295.625,-44.4927 303.383,-34.3551\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;O2 -->\n",
       "<g id=\"edge30\" class=\"edge\"><title>O&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M245.343,-288.153C255.949,-262.962 280.87,-215.38 298.298,-186.696\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"301.338,-188.436 303.666,-178.1 295.401,-184.729 301.338,-188.436\"/>\n",
       "</g>\n",
       "<!-- O&#45;&gt;HO2 -->\n",
       "<g id=\"edge51\" class=\"edge\"><title>O&#45;&gt;HO2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M260.58,-293.284C285.037,-280.765 326.816,-260.974 356.154,-247.988\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"357.823,-251.078 365.584,-243.865 355.019,-244.664 357.823,-251.078\"/>\n",
       "</g>\n",
       "<!-- OH&#45;&gt;H -->\n",
       "<g id=\"edge15\" class=\"edge\"><title>OH&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M297.265,-103.407C251.256,-139.541 141.913,-247.004 196,-324 222.227,-361.336 277.442,-372.49 314.787,-375.749\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"314.581,-379.243 324.808,-376.474 315.086,-372.261 314.581,-379.243\"/>\n",
       "</g>\n",
       "<!-- OH&#45;&gt;H2O -->\n",
       "<g id=\"edge14\" class=\"edge\"><title>OH&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M304.56,-73.4647C302.54,-64.9458 302.006,-54.1712 302.956,-44.458\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"306.426,-44.9228 304.57,-34.4918 299.516,-43.8036 306.426,-44.9228\"/>\n",
       "</g>\n",
       "<!-- OH&#45;&gt;H2O -->\n",
       "<g id=\"edge35\" class=\"edge\"><title>OH&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M327.44,-73.4647C329.46,-64.9458 329.994,-54.1712 329.044,-44.458\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"332.484,-43.8036 327.43,-34.4918 325.574,-44.9228 332.484,-43.8036\"/>\n",
       "</g>\n",
       "<!-- OH&#45;&gt;O2 -->\n",
       "<g id=\"edge36\" class=\"edge\"><title>OH&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M321.879,-107.956C322.714,-115.827 322.948,-125.374 322.583,-134.187\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"319.074,-134.184 321.84,-144.411 326.056,-134.691 319.074,-134.184\"/>\n",
       "</g>\n",
       "<!-- H2&#45;&gt;H -->\n",
       "<g id=\"edge9\" class=\"edge\"><title>H2&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M475.614,-178.699C468.159,-196.951 458.812,-227.68 446,-252 427.48,-287.155 418.458,-293.492 393,-324 384.809,-333.816 375.293,-344.141 367.328,-353.044\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"364.512,-350.946 360.532,-360.765 369.767,-355.571 364.512,-350.946\"/>\n",
       "</g>\n",
       "<!-- H2&#45;&gt;H -->\n",
       "<g id=\"edge12\" class=\"edge\"><title>H2&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M488.346,-180.023C485.712,-198.411 476.507,-228.259 464,-252 445.48,-287.155 436.458,-293.492 411,-324 401.087,-335.879 389.233,-348.506 378.573,-358.454\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"376.182,-355.897 371.068,-365.175 380.852,-361.111 376.182,-355.897\"/>\n",
       "</g>\n",
       "<!-- H2&#45;&gt;OH -->\n",
       "<g id=\"edge10\" class=\"edge\"><title>H2&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M462.366,-153.106C431.867,-141.618 379.207,-120.093 345.968,-105.65\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"347.295,-102.411 336.732,-101.597 344.482,-108.821 347.295,-102.411\"/>\n",
       "</g>\n",
       "<!-- H2&#45;&gt;OH -->\n",
       "<g id=\"edge13\" class=\"edge\"><title>H2&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M465.19,-150.369C433.313,-136.217 373.14,-111.515 339.654,-98.9012\"/>\n",
       "</g>\n",
       "<!-- H2&#45;&gt;H2O -->\n",
       "<g id=\"edge11\" class=\"edge\"><title>H2&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M469.7,-147.384C439.617,-122.257 375.246,-68.4878 340.106,-39.1356\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"342.17,-36.2989 332.251,-32.5743 337.682,-41.6713 342.17,-36.2989\"/>\n",
       "</g>\n",
       "<!-- H2O&#45;&gt;OH -->\n",
       "<g id=\"edge18\" class=\"edge\"><title>H2O&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M316,-36.1043C316,-43.7913 316,-53.0537 316,-61.6651\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"312.5,-61.6966 316,-71.6966 319.5,-61.6967 312.5,-61.6966\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;O -->\n",
       "<g id=\"edge4\" class=\"edge\"><title>O2&#45;&gt;O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M311.66,-179.838C301.069,-204.996 276.192,-252.501 258.765,-281.199\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"255.721,-279.467 253.397,-289.804 261.66,-283.172 255.721,-279.467\"/>\n",
       "</g>\n",
       "<!-- O2&#45;&gt;OH -->\n",
       "<g id=\"edge5\" class=\"edge\"><title>O2&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M310.16,-144.411C309.297,-136.507 309.048,-126.852 309.412,-117.935\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"312.903,-118.179 310.121,-107.956 305.921,-117.683 312.903,-118.179\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;H -->\n",
       "<g id=\"edge21\" class=\"edge\"><title>HO2&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M384.616,-251.825C377.499,-279.14 363.511,-332.824 356.39,-360.153\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;H -->\n",
       "<g id=\"edge25\" class=\"edge\"><title>HO2&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M393.72,-251.838C392.432,-279.719 377.894,-335.045 364.7,-361.804\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;O -->\n",
       "<g id=\"edge29\" class=\"edge\"><title>HO2&#45;&gt;O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M369.099,-246.881C341.714,-260.882 293.037,-283.815 264.089,-296.276\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;OH -->\n",
       "<g id=\"edge24\" class=\"edge\"><title>HO2&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M372.162,-219.646C360.098,-201.894 347.919,-169.764 334,-144 329.083,-134.899 322.987,-125.415 318.082,-117.029\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"321.06,-115.181 313.174,-108.105 314.926,-118.554 321.06,-115.181\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;OH -->\n",
       "<g id=\"edge28\" class=\"edge\"><title>HO2&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M383.153,-216.133C376.56,-197.88 365.044,-168.145 352,-144 346.686,-134.165 339.997,-123.883 333.83,-115.022\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"336.559,-112.82 327.908,-106.703 330.856,-116.88 336.559,-112.82\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;OH -->\n",
       "<g id=\"edge34\" class=\"edge\"><title>HO2&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M396.453,-216.466C394.701,-198.242 383.124,-168.292 370,-144 361.541,-128.342 349.593,-111.553 337.427,-101.164\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;H2 -->\n",
       "<g id=\"edge19\" class=\"edge\"><title>HO2&#45;&gt;H2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M406.791,-220.161C421.695,-209.405 443.172,-193.907 460.003,-181.761\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"462.261,-184.448 468.321,-175.758 458.164,-178.771 462.261,-184.448\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;H2O -->\n",
       "<g id=\"edge32\" class=\"edge\"><title>HO2&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M415.916,-230.916C447.418,-226.871 498.288,-214.975 522,-180 530.979,-166.757 529.519,-158.123 522,-144 486.76,-77.811 399.873,-43.0283 350.943,-28.1215\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"351.691,-24.6935 341.11,-25.2381 349.721,-31.4106 351.691,-24.6935\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;O2 -->\n",
       "<g id=\"edge20\" class=\"edge\"><title>HO2&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M367.894,-222.369C354.941,-213.082 339.551,-199.251 328.395,-187.275\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"330.985,-184.92 321.744,-179.739 325.737,-189.552 330.985,-184.92\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;O2 -->\n",
       "<g id=\"edge27\" class=\"edge\"><title>HO2&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M374.227,-218.834C363.838,-208.872 349.756,-195.369 338.043,-184.137\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"340.391,-181.539 330.751,-177.144 335.546,-186.592 340.391,-181.539\"/>\n",
       "</g>\n",
       "<!-- HO2&#45;&gt;O2 -->\n",
       "<g id=\"edge33\" class=\"edge\"><title>HO2&#45;&gt;O2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M383.085,-216.055C373.87,-204.961 358.794,-190.534 344.899,-179.525\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"346.996,-176.723 336.907,-173.489 342.778,-182.309 346.996,-176.723\"/>\n",
       "</g>\n",
       "<!-- H2O2 -->\n",
       "<g id=\"node8\" class=\"node\"><title>H2O2</title>\n",
       "<ellipse fill=\"none\" stroke=\"black\" cx=\"435\" cy=\"-450\" rx=\"31.948\" ry=\"18\"/>\n",
       "<text text-anchor=\"middle\" x=\"435\" y=\"-445.8\" font-family=\"Times,serif\" font-size=\"14.00\">H2O2</text>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;H -->\n",
       "<g id=\"edge39\" class=\"edge\"><title>H2O2&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M414.412,-436.161C398.636,-424.32 377.675,-406.731 364.337,-394.194\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;H -->\n",
       "<g id=\"edge44\" class=\"edge\"><title>H2O2&#45;&gt;H</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M422.3,-433.465C408.545,-420.576 386.967,-402.523 371.19,-390.795\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;O -->\n",
       "<g id=\"edge49\" class=\"edge\"><title>H2O2&#45;&gt;O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M407.62,-440.763C382.219,-432.247 344.198,-417.205 316,-396 288.385,-375.233 264.198,-342.499 251.181,-323.051\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;OH -->\n",
       "<g id=\"edge38\" class=\"edge\"><title>H2O2&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M443.485,-432.5C451.48,-422.583 462.48,-409.333 470,-396 525.817,-297.037 582.616,-233.794 513,-144 493.155,-118.403 403.785,-103 352.382,-95.8396\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"352.714,-92.3526 342.334,-94.4764 351.773,-99.2891 352.714,-92.3526\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;OH -->\n",
       "<g id=\"edge47\" class=\"edge\"><title>H2O2&#45;&gt;OH</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M455.437,-436.056C466.676,-425.894 479.54,-411 488,-396 543.817,-297.037 600.616,-233.794 531,-144 509.743,-116.582 408.721,-100.861 352.913,-94.4362\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"353.044,-90.9294 342.72,-93.3092 352.275,-97.887 353.044,-90.9294\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;H2 -->\n",
       "<g id=\"edge43\" class=\"edge\"><title>H2O2&#45;&gt;H2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M442.872,-432.371C458.154,-399.063 491.359,-321.404 503,-252 505.647,-236.22 505.473,-231.808 503,-216 501.62,-207.176 499.02,-197.816 496.262,-189.456\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"499.507,-188.134 492.89,-179.859 492.903,-190.454 499.507,-188.134\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;H2O -->\n",
       "<g id=\"edge37\" class=\"edge\"><title>H2O2&#45;&gt;H2O</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M465.461,-444.88C528.618,-434.446 668,-400.796 668,-307 668,-307 668,-307 668,-161 668,-93.414 441.997,-42.9674 352.176,-25.587\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"352.648,-22.1141 342.17,-23.679 351.337,-28.9902 352.648,-22.1141\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;HO2 -->\n",
       "<g id=\"edge42\" class=\"edge\"><title>H2O2&#45;&gt;HO2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M426.457,-432.5C417.184,-403.293 404.839,-340.611 393,-288 391.099,-279.551 388.898,-270.379 387.263,-262.077\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"390.7,-261.411 385.561,-252.146 383.801,-262.594 390.7,-261.411\"/>\n",
       "</g>\n",
       "<!-- H2O2&#45;&gt;HO2 -->\n",
       "<g id=\"edge48\" class=\"edge\"><title>H2O2&#45;&gt;HO2</title>\n",
       "<path fill=\"none\" stroke=\"black\" d=\"M437.18,-432.033C435.054,-402.63 422.777,-340.332 411,-288 408.967,-278.965 406.591,-269.102 403.929,-260.362\"/>\n",
       "<polygon fill=\"black\" stroke=\"black\" points=\"407.193,-259.087 400.677,-250.733 400.561,-261.327 407.193,-259.087\"/>\n",
       "</g>\n",
       "</g>\n",
       "</svg>\n"
      ],
      "text/plain": [
       "<graphviz.dot.Digraph at 0x113a014a8>"
      ]
     },
     "execution_count": 110,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
